{% extends 'landingpage.html' %}
{% block body %}



  <main>
    <article>

     
      <form action="{{ url_for('addalumni') }}" method="post" enctype="multipart/form-data" >
        {{form.hidden_tag()}}
     
          <section class="section newslettr" aria-label="newsletter">
            <div class="container" style="background-color:#fff; padding:30px;">

              <h2 class="h4 section-title" style="text-align:left;">
                Add Product
               </h2>

               <label for="image-picker" style="">
                <div>
                    {% if editCandidate %}
                    <img id="image-preview" style="height: 20vh; margin:auto; object-fit:contain" src={{candidate.testField}} alt="your image" />
                    {% else %}
                    <img id="image-preview" style="height: 20vh; margin:auto; object-fit:contain" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAeFBMVEX///8AAABLS0v09PTc3Nx0dHT7+/t/f3/s7OySkpLi4uKCgoKYmJjm5uZUVFTLy8sbGxsLCwu/v7+goKCKioozMzPKysq5ubmwsLBdXV3R0dFBQUErKyshISFqamp5eXmdnZ04ODhjY2MUFBQ3Nzc/Pz+pqalISEjvIqkVAAAGL0lEQVR4nO2daUPiPBCAgUopCFXuUxd1Zf//P3zlxaOTJk2aTDOT3Xm+qk0e0+aYXL2eIAiCIAiCIAhC1xS70fFx3qdl/jRY7YpO9M5rYrcqx0uG7JfdUzvVGKM67t6ofTQ8LtD88j21jIFfSILFb2oTIyXKm1pwqmFU/uThgjnfErwyCDfk+g1+cR8quKM2sLIJE8youzB21mGf4og6/w4sQwQL6tw7EWJ4ps68E9sAw1pT+LwoMlpm21rtXvoLzpRHvUwC/lt4HNResn/PRmkqXrBHLL6o1YN/g6HUpDxK8MoCZsy/Nj3CbxAxi6GUIGdD7+c8gufgDcfCWSJVNbBD00lwxJMDyJl/9xurxsLnTgwdEUM6xNAVMaSD3nCyvd8PBuXreNPN/4Xa8PJe+bP9g3f6ZmgNa8Gr48E7ByYoDQvYKb6x8s6CAUJDmPRPHhBi0+ZkYhrCHnGFE26NQ2ZoKMEr7965sCcUzzBvmsQJDr9XoTJsnijGbDWIDCeNgv0X73zUITJ8bjbEDIPQGFqnAAIityo0hhebIWKkh8bQPpe6886JColhY1NxY+SdExUSQ3WSQ8PROycqJIaWtuLKk3dOVLgavnnnRIWr4aN3TlS4Gp68c6JCYljYV/ftvXOiQtMe/rEaTr1zokJjaF+Zgje6oDE0ju+/8c5IDaKxxZNFEDEeRWRo63rPvDNSg2qMD2fFVTDDGFSGD02CT5jRNrJY26rBEDXwTRcvfTUKXrxzoYMw5m0aBgctkaxDOW+hjyhir8UhnXta1JvFErGduEE7u5ZP4d+9dLCYinqGtLd5/moa1yv8ycMeA8MPZofN5uHgEj/MdqPhqOWGOw6Gzlw+V8+1qm1TMvzpJLSJNSZkWO0FtVgmmo4h7Oa5KyZjqPZjnTcUpmJY76i7KiZiqBuJOCqmYagfarkpJmFoGks6NRopGJoHyy6lmIBhUzTAQZG/4bhB0OVFZW/YVIJOitwNbYJ2ReaGza+okyJvQxdBW/yYtaGboKUUORvav0EXRcaGriVoUeRr2Eaw6VuMbJjtxqvzncsD3V/RG8ZSjGv4GR4d2B3bleAVUylGNfyZqbBtqW4vaFSMaVidimlW9BE0KUY0hNNpTfF7P0GDYjxDdb7QXIq+gnrFaIb1CVGTor+gdg1HLEPdjK9eMURQV4qRDPVr83WKYYIaxTiGps0HdcWp4TfdUV/UKIbm3RXqjGG4YE0xhuGwITtwhV7oK3oDrmuMYdi41rL6omKUYF+dtYlhOGjMz8+LiiTIzvBbEUuQn+Hnt4jzDfI0/L8U0UqQpeGHIqIgS8P+L0RBnoaoiKEYpm3ov/0WpsHJMANLPMd/oSHcoON/3CFMg5VhVvlRwDYHmAYrw8qX+OovyNqwN/uMEp0DBHkb9nqT5XS6DTv4hrkhAmIohmIohmIohmIohmIohmJoNcwfFgunpViJGua3JWTroLuCOBsW37Eo/zgUb8PK2WkBW/1hGqwMwaSP/7pQmAYnw/xU/Zn/cQYwDU6G8Ngt//OnYBqcDP+1eQsxFMMvxLBb4hvC2666J77hahgX2Krz3TODhRi6IoZ0iKErYkgHliG8/xD90LUAsAzh2XIh1+5ig2UI+554JzmHg2WobGrt5Gw5P7AMldu33vjcRIplWLt1hM11sliG9SFSuTzcdYKpKcon2l+HVx4fZ9pfcqn87RerYPE00jpOT/Y/NVPaa45sbn8MGvVppMJ+7YkF+zn3eHteHFDfqtx2BLoD1nA4RiLOqAtF257AoMVa/y/sz8ADrmbOUZ5pn3uz33iAB3ylGs8/d8bh1hDdnZQdAesFpNfHbpjZb+bAogvDud2wl0cL/sLRS8N1kS1w223SfK8hHsqa7eDW8IrjmG/zGyMxG2c1VYRnrt0EP1gipGahvm8Cob/RZjvNtuNKVXdHS+3y5Ja8txzvZZvlsBx0QjnW/7Oz5V77+3DQ86Z/6JDNYM8DeFFfwPiQLWgjYLaIYfqIYfqIYfqIYfqIYfqIYfqIYfqIYfqIYfqIYfrAWFs3+0uJAeHplOOiRqoXub9TZ6YbKhsQ+SzVwuVrrc+a06pQXIrxqT8vOa0JFQRBEARBEAThn+E/iJNoanbU+6oAAAAASUVORK5CYII=" alt="your image" />
                    {% endif %}
                </div>      
                <h6 id="error" style="color: red; display: none;">Please upload an image to continue</h6>
            </label>
           
              <div class="input-group mb-3">
                <span class="input-group-text" >Name</span>
                {{form.qualities(class="form-control", style="color:#000;", placeholder="Enter Name", required="required")}}
              </div>

              <div class="input-group mb-3">
                <span class="input-group-text">Number</span>
                {{form.reason( class="form-control", type="number", placeholder="",id="floatingInput", required="required")}}
                
                <span class="input-group-text"></span>
              </div>

              <div class="input-group mb-3">
                {{form.campus( class="form-control", type="number", placeholder="",id="floatingInput", required="required")}}
              </div>
              
              <div class="input-group mb-3">
                {{form.fullname(class="form-control", type="number", id="floatingInput", required="required", placeholder="")}}
                <span class="input-group-text" id="basic-addon2">Unit</span>
              </div>
              

            
              <div class="input-group">
                <span class="input-group-text">Add Notes</span>
                <textarea name="position" type="position" class="form-control" placeholder="" required="required">       </textarea>
              
              </div>
    
              <div class="newsletter-content" data-reveal="right">
                
                
                
                
            
                
                
               
                
                 
               
                  
                  
                  
               
                  
                  <!--{{form.position( class="input-field my-5 my-lg-5 mt-2 space", style="  margin-bottom:90px;",placeholder="Position",id="floatingInput")}}
                  -->
                  {{form.image_file (class="form-control",style="display:none;", id="firebaseLink" )}}
                 
                
                <input style="display:none" id="image-picker" type="file" required="required" accept="image/*" />
                
<div id="submitButton">
  {{form.submit( class="submit", class="btn btn-primary has-before has-after",style="margin-top:30px; width:100%;" )}}
  
</div>  


                   
                 
        </div>
      </section>



     
   
     

    </article>
  </main>






              
</form>

<!--<script>
  // JavaScript code to send the email after form submission
  const form = document.querySelector('form');
  form.addEventListener('submit', async (event) => {
      event.preventDefault(); // Prevent the default form submission
      
      // Perform the form submission using AJAX or Fetch
      try {
          const response = await fetch(form.action, {
              method: 'POST',
              body: new FormData(form)
          });
          
          if (response.ok) {
              // Form submitted successfully, now trigger the email sending
              await fetch('/send_email', {
                  method: 'POST'
              });
              alert('Form submitted and email sent successfully!');
          } else {
              alert('Form submission failed.');
          }
      } catch (error) {
          console.error('An error occurred:', error);
      }
  });
</script>-->




<script>

$("#image-picker").change(function (event) {
  readURL(this);
  console.log ('touch image')
    document.getElementById('error').style.display = 'none';

});
    function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        pushImage(input.files[0])

        reader.onload = function (e) {
            $('#image-preview').attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);


    }
}
</script>

  
<script>

  
  
  // Push batch images to storage and store references in the database
  var pushImage = function (file) {
   document.getElementById('submitButton').innerHTML = `
         <button class="button" style="background-color: #7272F2;"><i class="fa fa-pause-circle-o" aria-hidden="true" style="color:'white'"></i>Uploading</button>
         `
     // var uid = firebase.auth().currentUser.uid;
     // Create storage reference
     var ref = firebase.storage().ref(`/alumni/`).child(file.name + ".jpg");
     //var ref = firebase.storage().ref(``).child(file.name + ".jpg");
 
     // Upload file and get task
     var task = ref.put(file, {contentType: file.type});
  
     // Monitor task for progress
     task.on('state_changed',
         // Shows progress of task
         function progress(snapshot) {
             var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
             console.log(percentage);
         },
         // Shows any errors occurring during progress
         function error(err) {
             // Handle unsuccessful uploads
             console.log(err.message);
 
         },
         // Shows when task is completed
         );  
 };
 
 
   function changeimagesss(event) {
     console.log(event)
     // console.log(event.target.files[0])
     // var uploadItem = event.target.files[0]
     // console.log(uploadItem)
     pushImage(event)
 
     
   }
 
  </script>

  <script>

    var firebaseLink = document.getElementById("firebaseLink").innerText
    // Push batch images to storage and store references in the database
    var pushImage = function (file) {
        document.getElementById('submitButton').innerHTML = `
        <button class="button" style="background-color: #da2d2770;"><i class="fa fa-pause-circle-o" aria-hidden="true" style="color:'white'"></i>Please wait while we upload your image</button>
        `

       // var uid = firebase.auth().currentUser.uid;
       // Create storage reference
       var ref = firebase.storage().ref(`/ineruu-142dc-default-rtdb/Images/`).child(file.name + ".jpg");
   
       // Upload file and get task
       var task = ref.put(file, {contentType: file.type});
    
       // Monitor task for progress
       task.on('state_changed',
           // Shows progress of task
           function progress(snapshot) {
               var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
               console.log(percentage);
           },
           // Shows any errors occurring during progress
           function error(err) {
               // Handle unsuccessful uploads
               console.log(err.message);
   
           },
           // Shows when task is completed
           function complete() {
               // Handle successful uploads on complete
               var image = task.snapshot.downloadUrl;
               var secondImage = task.snapshot.ref.getDownloadURL().then(function(downloadURL) {
           console.log('File available at', downloadURL);
        //    firebaseLink = downloadURL
           document.getElementById("firebaseLink").value = downloadURL
        //    console.log("Firebase Link: " + firebaseLink)
            document.getElementById('submitButton').innerHTML = `{{form.submit (class="button")}}`

         });
            //    console.log(task);
            //    console.log(image);
            //    console.log(secondImage.PromiseResult).then(res => {
            //        console.log("THis is" + res)
                   
            //    });
   
               // Data model to be uploaded to the database
               var data = {
                   imageUrl: image
               };
               
               // var db = firebase.database().ref(/GHotelBookMan/Hotels/${uid}/Images).push();
               // db.set(data).then(() => {
               //     row.empty();
               //     loadCurrentHotel(uid);
               // });
           });  
   };
   
   
     function changeimagesss(event) {
       console.log(event)
       // console.log(event.target.files[0])
       // var uploadItem = event.target.files[0]
       // console.log(uploadItem)
       pushImage(event)
   
       
     }
   
    </script> 


{% endblock body %}